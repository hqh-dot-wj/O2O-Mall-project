# P1 优先级改进使用指南

##  改进概览

本次 P1 改进实现了营销引擎的两大核心功能，提升系统的可扩展性和可维护性：

| 功能 | 核心文件 | 作用 |
|------|---------|------|
| **事件驱动机制** | `events/` 目录 | 解耦模块依赖，提升可扩展性 |
| **玩法注册表系统** | `play.registry.ts` + `play-strategy.decorator.ts` | 标准化玩法管理，新增玩法无需改核心代码 |

---

##  P1 改进目标

### 核心目标
1. **解耦模块依赖**: 通过事件驱动机制实现模块间松耦合
2. **标准化玩法管理**: 建立统一的玩法元数据管理系统
3. **简化玩法开发**: 新增玩法从 1 天缩短到 2 小时
4. **提升可扩展性**: 支持未来 100+ 种营销玩法

### 技术亮点
-  事件驱动架构（基于 NestJS EventEmitter2）
-  装饰器自动注册（基于 Reflect Metadata）
-  完整的类型定义（TypeScript 严格模式）
-  100% 中文注释覆盖

---

## 1 事件驱动机制

### 功能说明

事件驱动机制用于解耦模块依赖，提升系统可扩展性。通过事件总线实现模块间通信，避免直接依赖。

**核心优势**:
-  **解耦**: 发送方和接收方互不依赖
-  **异步**: 支持异步处理，不阻塞主流程
-  **可扩展**: 新增监听器无需修改发送方代码
-  **可追踪**: 完整的事件日志记录

### 核心文件

```
apps/backend/src/module/marketing/events/
 marketing-event.types.ts      # 事件类型定义
 marketing-event.emitter.ts    # 事件发射器
 marketing-event.listener.ts   # 事件监听器
 events.module.ts              # 事件模块
```

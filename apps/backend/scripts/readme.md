# Backend Scripts ç›®å½•è¯´æ˜

æœ¬ç›®å½•åŒ…å«åç«¯é¡¹ç›®çš„å„ç±»è„šæœ¬å·¥å…·ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»ç»„ç»‡ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„

```
scripts/
â”œâ”€â”€ debug/          # è°ƒè¯•è„šæœ¬
â”œâ”€â”€ seed/           # æ•°æ®ç§å­è„šæœ¬
â”œâ”€â”€ setup/          # ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ verify/         # éªŒè¯æµ‹è¯•è„šæœ¬
â”œâ”€â”€ test/           # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ deploy/         # éƒ¨ç½²ç›¸å…³è„šæœ¬
â”œâ”€â”€ utils/          # å·¥å…·è„šæœ¬
â””â”€â”€ README.md       # æœ¬æ–‡ä»¶
```

---

## ğŸ” debug/ - è°ƒè¯•è„šæœ¬

ç”¨äºè°ƒè¯•å’Œæ’æŸ¥é—®é¢˜çš„è„šæœ¬ã€‚

| æ–‡ä»¶                     | è¯´æ˜                  |
| ------------------------ | --------------------- |
| `debug-aggregation.ts`   | æ£€æŸ¥äº§å“-æ´»åŠ¨èšåˆæ•°æ® |
| `debug-products.ts`      | è°ƒè¯•äº§å“æ•°æ®          |
| `debug-templates.ts`     | è°ƒè¯•è¥é”€æ¨¡æ¿æ•°æ®      |
| `debug-captcha-issue.ts` | è°ƒè¯•éªŒè¯ç é—®é¢˜        |
| `debug-prisma.ts`        | è°ƒè¯• Prisma ç›¸å…³é—®é¢˜  |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/debug/debug-aggregation.ts
```

---

## ğŸŒ± seed/ - æ•°æ®ç§å­è„šæœ¬

ç”¨äºåˆå§‹åŒ–æµ‹è¯•æ•°æ®çš„è„šæœ¬ã€‚

| æ–‡ä»¶                         | è¯´æ˜             |
| ---------------------------- | ---------------- |
| `seed-marketing-activity.ts` | ç§å­è¥é”€æ´»åŠ¨æ•°æ® |
| `seed-courses.cjs`           | ç§å­è¯¾ç¨‹æ•°æ®     |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/seed/seed-marketing-activity.ts
```

---

## âš™ï¸ setup/ - ç¯å¢ƒè®¾ç½®è„šæœ¬

ç”¨äºè®¾ç½®å¼€å‘/ç”Ÿäº§ç¯å¢ƒçš„è„šæœ¬ã€‚

| æ–‡ä»¶               | è¯´æ˜               |
| ------------------ | ------------------ |
| `setup-postgis.ts` | è®¾ç½® PostGIS æ‰©å±•  |
| `setup-tenant.cjs` | è®¾ç½®ç§Ÿæˆ·ç¯å¢ƒ       |
| `init-regions.ts`  | åˆå§‹åŒ–è¡Œæ”¿åŒºåˆ’æ•°æ® |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/setup/setup-postgis.ts
```

---

## âœ… verify/ - éªŒè¯æµ‹è¯•è„šæœ¬

ç”¨äºéªŒè¯ç³»ç»ŸåŠŸèƒ½çš„è„šæœ¬ã€‚

| æ–‡ä»¶                | è¯´æ˜              |
| ------------------- | ----------------- |
| `verify-lbs.ts`     | éªŒè¯ LBS æ¨¡å—åŠŸèƒ½ |
| `verify-schema.sql` | éªŒè¯æ•°æ®åº“ Schema |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/verify/verify-lbs.ts
```

---

## ğŸ§ª test/ - æµ‹è¯•è„šæœ¬

ç”¨äºæµ‹è¯•ç‰¹å®šåŠŸèƒ½çš„è„šæœ¬ã€‚

| æ–‡ä»¶                           | è¯´æ˜             |
| ------------------------------ | ---------------- |
| `test-auto-cancel.ts`          | æµ‹è¯•è‡ªåŠ¨å–æ¶ˆè®¢å• |
| `test-commission-matrix.ts`    | æµ‹è¯•ä½£é‡‘çŸ©é˜µ     |
| `test-risks.ts`                | æµ‹è¯•é£æ§åŠŸèƒ½     |
| `test-system-config.cjs`       | æµ‹è¯•ç³»ç»Ÿé…ç½®     |
| `test-system-config-direct.ts` | ç›´æ¥æµ‹è¯•ç³»ç»Ÿé…ç½® |
| `test-e2e.cjs`                 | ç«¯åˆ°ç«¯æµ‹è¯•       |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/test/test-auto-cancel.ts
```

---

## ğŸš€ deploy/ - éƒ¨ç½²è„šæœ¬

ç”¨äºéƒ¨ç½²åº”ç”¨çš„è„šæœ¬ã€‚

| æ–‡ä»¶                        | è¯´æ˜         |
| --------------------------- | ------------ |
| `deploy.cjs`                | éƒ¨ç½²è„šæœ¬     |
| `deploy-config-example.cjs` | éƒ¨ç½²é…ç½®ç¤ºä¾‹ |
| `ecosystem-config.cjs`      | PM2 ç”Ÿæ€é…ç½® |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
node scripts/deploy/deploy.cjs
```

---

## ğŸ› ï¸ utils/ - å·¥å…·è„šæœ¬

é€šç”¨å·¥å…·è„šæœ¬ã€‚

| æ–‡ä»¶                       | è¯´æ˜            |
| -------------------------- | --------------- |
| `generate-rsa-keys.cjs`    | ç”Ÿæˆ RSA å¯†é’¥å¯¹ |
| `generate-test-data.ts`    | ç”Ÿæˆæµ‹è¯•æ•°æ®    |
| `clear-config-cache.ts`    | æ¸…ç†é…ç½®ç¼“å­˜    |
| `clear-configs.cjs`        | æ¸…ç†é…ç½®        |
| `check-captcha-config.ts`  | æ£€æŸ¥éªŒè¯ç é…ç½®  |
| `migrate-system-config.ts` | è¿ç§»ç³»ç»Ÿé…ç½®    |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
node scripts/utils/generate-rsa-keys.cjs
```

---

## ğŸ”„ reset/ - é‡ç½®è„šæœ¬

ç”¨äºé‡ç½®æ•°æ®çš„è„šæœ¬ã€‚

| æ–‡ä»¶                       | è¯´æ˜             |
| -------------------------- | ---------------- |
| `reset-marketing-full.cjs` | å®Œå…¨é‡ç½®è¥é”€æ•°æ® |
| `reset-templates-only.cjs` | ä»…é‡ç½®æ¨¡æ¿æ•°æ®   |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
node scripts/reset/reset-marketing-full.cjs
```

---

## ğŸ­ simulate/ - æ¨¡æ‹Ÿè„šæœ¬

ç”¨äºæ¨¡æ‹Ÿä¸šåŠ¡æµç¨‹çš„è„šæœ¬ã€‚

| æ–‡ä»¶                    | è¯´æ˜             |
| ----------------------- | ---------------- |
| `simulate-flow.ts`      | æ¨¡æ‹Ÿä¸šåŠ¡æµç¨‹     |
| `simulate-full-flow.ts` | æ¨¡æ‹Ÿå®Œæ•´ä¸šåŠ¡æµç¨‹ |
| `simulation-report.txt` | æ¨¡æ‹ŸæŠ¥å‘Š         |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx scripts/simulate/simulate-flow.ts
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **TypeScript è„šæœ¬**ï¼šä½¿ç”¨ `npx tsx` è¿è¡Œ
2. **CommonJS è„šæœ¬**ï¼šä½¿ç”¨ `node` è¿è¡Œ
3. **ç¯å¢ƒå˜é‡**ï¼šç¡®ä¿ `.env` æ–‡ä»¶é…ç½®æ­£ç¡®
4. **æ•°æ®åº“è¿æ¥**ï¼šç¡®ä¿æ•°æ®åº“æœåŠ¡æ­£å¸¸è¿è¡Œ
5. **æƒé™é—®é¢˜**ï¼šæŸäº›è„šæœ¬å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ–‡æ¡£](../docs/)
- [API æ–‡æ¡£](../docs/API_REFERENCE.md)
- [éƒ¨ç½²æŒ‡å—](../docs/deployment/)

---

**æœ€åæ›´æ–°**ï¼š2026-02-22
**ç»´æŠ¤è€…**ï¼šBackend Team

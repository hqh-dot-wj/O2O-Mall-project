# Prisma Seeds ç›®å½•è¯´æ˜

æœ¬ç›®å½•åŒ…å« Prisma æ•°æ®åº“çš„ç§å­æ•°æ®è„šæœ¬å’Œç›¸å…³å·¥å…·ï¼Œç”¨äºåœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸­å¿«é€Ÿæ­å»ºåŸºç¡€æ•°æ®ã€‚

---

## ğŸ“ ç›®å½•ç»“æ„

```
prisma/
â”œâ”€â”€ seeds/
â”‚   â”œâ”€â”€ data/       # ç§å­æ•°æ®è„šæœ¬
â”‚   â”œâ”€â”€ reset/      # é‡ç½®è„šæœ¬
â”‚   â”œâ”€â”€ setup/      # è®¾ç½®è„šæœ¬
â”‚   â”œâ”€â”€ utils/      # å·¥å…·è„šæœ¬
â”‚   â””â”€â”€ fix/        # ä¿®å¤è„šæœ¬
â”œâ”€â”€ migrations/     # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”œâ”€â”€ schema.prisma   # Prisma Schema å®šä¹‰
â”œâ”€â”€ seed.ts         # ä¸»ç§å­æ•°æ®å…¥å£
â””â”€â”€ SEED_README.md  # æœ¬æ–‡ä»¶
```

---

## ğŸŒ± seeds/data/ - ç§å­æ•°æ®è„šæœ¬

ç”¨äºåˆå§‹åŒ–å„ç±»åŸºç¡€æ•°æ®çš„è„šæœ¬ã€‚

| æ–‡ä»¶                             | è¯´æ˜                 |
| -------------------------------- | -------------------- |
| `seed-templates.ts`              | åˆå§‹åŒ–è¥é”€æ¨¡æ¿æ•°æ®   |
| `seed-coupon-templates.ts`       | åˆå§‹åŒ–ä¼˜æƒ åˆ¸æ¨¡æ¿æ•°æ® |
| `seed-points-rules.ts`           | åˆå§‹åŒ–ç§¯åˆ†è§„åˆ™æ•°æ®   |
| `seed-course.ts`                 | åˆå§‹åŒ–è¯¾ç¨‹æ•°æ®       |
| `seed-course-products.ts`        | åˆå§‹åŒ–è¯¾ç¨‹äº§å“æ•°æ®   |
| `file-management-config.seed.ts` | åˆå§‹åŒ–æ–‡ä»¶ç®¡ç†é…ç½®   |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx prisma/seeds/data/seed-templates.ts
npx tsx prisma/seeds/data/seed-coupon-templates.ts
```

---

## ğŸ”„ seeds/reset/ - é‡ç½®è„šæœ¬

ç”¨äºé‡ç½®ç‰¹å®šæ¨¡å—æ•°æ®çš„è„šæœ¬ã€‚

| æ–‡ä»¶                           | è¯´æ˜               |
| ------------------------------ | ------------------ |
| `reset-marketing-all.ts`       | é‡ç½®æ‰€æœ‰è¥é”€æ•°æ®   |
| `reset-marketing-templates.ts` | ä»…é‡ç½®è¥é”€æ¨¡æ¿æ•°æ® |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx prisma/seeds/reset/reset-marketing-all.ts
```

**âš ï¸ è­¦å‘Š**ï¼šé‡ç½®è„šæœ¬ä¼šåˆ é™¤ç°æœ‰æ•°æ®ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼

---

## âš™ï¸ seeds/setup/ - è®¾ç½®è„šæœ¬

ç”¨äºè®¾ç½®ç‰¹å®šåŠŸèƒ½æˆ–ç¯å¢ƒçš„è„šæœ¬ã€‚

| æ–‡ä»¶                      | è¯´æ˜             |
| ------------------------- | ---------------- |
| `setup-tenant-courses.ts` | è®¾ç½®ç§Ÿæˆ·è¯¾ç¨‹æ•°æ® |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
npx tsx prisma/seeds/setup/setup-tenant-courses.ts
```

---

## ğŸ› ï¸ seeds/utils/ - å·¥å…·è„šæœ¬

é€šç”¨å·¥å…·è„šæœ¬ã€‚

| æ–‡ä»¶                     | è¯´æ˜                               |
| ------------------------ | ---------------------------------- |
| `convert-sql-to-seed.ts` | å°† SQL æ–‡ä»¶è½¬æ¢ä¸º Prisma seed æ ¼å¼ |
| `clear-store-configs.ts` | æ¸…ç†é—¨åº—é…ç½®æ•°æ®                   |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
# è½¬æ¢ SQL åˆ° seed
npx tsx prisma/seeds/utils/convert-sql-to-seed.ts

# æ¸…ç†é—¨åº—é…ç½®
npx tsx prisma/seeds/utils/clear-store-configs.ts
```

---

## ğŸ”§ seeds/fix/ - ä¿®å¤è„šæœ¬

ç”¨äºä¿®å¤æ•°æ®é—®é¢˜çš„ SQL è„šæœ¬ã€‚

| æ–‡ä»¶               | è¯´æ˜             |
| ------------------ | ---------------- |
| `fix-level-id.sql` | ä¿®å¤å±‚çº§ ID é—®é¢˜ |

**ä½¿ç”¨æ–¹å¼**ï¼š

```bash
# ä½¿ç”¨ psql æ‰§è¡Œ
psql -U username -d database -f prisma/seeds/fix/fix-level-id.sql

# æˆ–ä½¿ç”¨ Prisma
npx prisma db execute --file prisma/seeds/fix/fix-level-id.sql
```

---

## ğŸ“ ä¸»ç§å­æ•°æ®å…¥å£

### seed.ts

ä¸»ç§å­æ•°æ®æ–‡ä»¶ï¼ŒåŒ…å«ç³»ç»Ÿåˆå§‹åŒ–æ‰€éœ€çš„æ ¸å¿ƒæ•°æ®ï¼š

1. **éƒ¨é—¨æ•°æ®** (10æ¡) - è‹¥ä¾ç§‘æŠ€ã€æ·±åœ³æ€»å…¬å¸ã€é•¿æ²™åˆ†å…¬å¸ç­‰
2. **ç”¨æˆ·æ•°æ®** (2æ¡) - adminã€ry
3. **è§’è‰²æ•°æ®** (2æ¡) - è¶…çº§ç®¡ç†å‘˜ã€æ™®é€šè§’è‰²
4. **å²—ä½æ•°æ®** (4æ¡) - è‘£äº‹é•¿ã€é¡¹ç›®ç»ç†ã€äººåŠ›èµ„æºã€æ™®é€šå‘˜å·¥
5. **å­—å…¸ç±»å‹** (10æ¡) - ç”¨æˆ·æ€§åˆ«ã€èœå•çŠ¶æ€ã€ç³»ç»Ÿå¼€å…³ç­‰
6. **å­—å…¸æ•°æ®** (29æ¡) - æ€§åˆ«å­—å…¸ã€èœå•æ˜¾ç¤ºçŠ¶æ€ç­‰
7. **ç³»ç»Ÿé…ç½®** (6æ¡) - ä¸»é¢˜é…ç½®ã€å¯†ç é…ç½®ã€éªŒè¯ç é…ç½®ç­‰
8. **èœå•æ•°æ®** (85æ¡) - ç³»ç»Ÿç®¡ç†æ¨¡å—èœå•
9. **å…³è”å…³ç³»** - ç”¨æˆ·-è§’è‰²ã€ç”¨æˆ·-å²—ä½ã€è§’è‰²-èœå•ã€è§’è‰²-éƒ¨é—¨

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. é¦–æ¬¡åˆå§‹åŒ–æ•°æ®åº“

```bash
# æ¨é€ schema åˆ°æ•°æ®åº“
npm run prisma:db:push

# è¿è¡Œä¸»ç§å­æ•°æ®
npm run prisma:seed
```

### 2. é‡ç½®æ•°æ®åº“å¹¶é‡æ–°åˆå§‹åŒ–

```bash
# é‡ç½®æ•°æ®åº“å¹¶è‡ªåŠ¨è¿è¡Œç§å­æ•°æ®
npm run prisma:reset
```

### 3. è¿è¡Œç‰¹å®šç§å­æ•°æ®

```bash
# è¿è¡Œè¥é”€æ¨¡æ¿ç§å­æ•°æ®
npx tsx prisma/seeds/data/seed-templates.ts

# è¿è¡Œä¼˜æƒ åˆ¸æ¨¡æ¿ç§å­æ•°æ®
npx tsx prisma/seeds/data/seed-coupon-templates.ts
```

### 4. é‡ç½®ç‰¹å®šæ¨¡å—æ•°æ®

```bash
# é‡ç½®è¥é”€æ•°æ®
npx tsx prisma/seeds/reset/reset-marketing-all.ts

# ä»…é‡ç½®è¥é”€æ¨¡æ¿
npx tsx prisma/seeds/reset/reset-marketing-templates.ts
```

---

## ğŸ” ç™»å½•ä¿¡æ¯

åˆå§‹åŒ–å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ç³»ç»Ÿï¼š

### ç®¡ç†å‘˜è´¦å·

- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`
- æƒé™: è¶…çº§ç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™

### æµ‹è¯•è´¦å·

- ç”¨æˆ·å: `ry`
- å¯†ç : `admin123`
- æƒé™: æ™®é€šè§’è‰²

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¯†ç åŠ å¯†**ï¼šç§å­æ•°æ®ä½¿ç”¨ bcrypt åŠ å¯†å¯†ç ï¼Œé»˜è®¤å¯†ç ä¸º `admin123`
2. **ä¸»é”®å†²çª**ï¼šå¦‚æœè¡¨ä¸­å·²å­˜åœ¨æ•°æ®ï¼ŒæŸäº›åˆ›å»ºæ“ä½œå¯èƒ½ä¼šå¤±è´¥
3. **å¼€å‘ç¯å¢ƒ**ï¼šå»ºè®®åœ¨å¼€å‘ç¯å¢ƒä½¿ç”¨ `prisma:reset` å‘½ä»¤å®Œå…¨é‡ç½®æ•°æ®åº“
4. **ç”Ÿäº§ç¯å¢ƒ**ï¼šè¯·è°¨æ…ä½¿ç”¨ç§å­æ•°æ®ï¼Œé¿å…è¦†ç›–é‡è¦æ•°æ®
5. **é‡ç½®è„šæœ¬**ï¼šé‡ç½®è„šæœ¬ä¼šåˆ é™¤ç°æœ‰æ•°æ®ï¼Œä½¿ç”¨å‰è¯·å¤‡ä»½

---

## ğŸ“š ç›¸å…³å‘½ä»¤

| å‘½ä»¤                      | è¯´æ˜                             |
| ------------------------- | -------------------------------- |
| `npm run prisma:generate` | ç”Ÿæˆ Prisma Client               |
| `npm run prisma:migrate`  | åˆ›å»ºå¹¶åº”ç”¨è¿ç§»                   |
| `npm run prisma:deploy`   | åº”ç”¨è¿ç§»ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰             |
| `npm run prisma:seed`     | è¿è¡Œä¸»ç§å­æ•°æ®                   |
| `npm run prisma:reset`    | é‡ç½®æ•°æ®åº“å¹¶è¿è¡Œç§å­æ•°æ®         |
| `npm run prisma:studio`   | æ‰“å¼€ Prisma Studio               |
| `npm run prisma:db:push`  | æ¨é€ schema åˆ°æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰ |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [Prisma å®˜æ–¹æ–‡æ¡£](https://www.prisma.io/docs)
- [Prisma Seeding æŒ‡å—](https://www.prisma.io/docs/guides/database/seed-database)
- [é¡¹ç›®æ–‡æ¡£](../docs/)

---

**æœ€åæ›´æ–°**ï¼š2026-02-22
**ç»´æŠ¤è€…**ï¼šBackend Team
